name: ğŸ¯ Update Korean TV Playlist

on:
  schedule:
    # æ¯å¤©UTCæ—¶é—´20:00è¿è¡Œï¼ˆåŒ—äº¬æ—¶é—´å‡Œæ™¨4:00ï¼‰
    - cron: '0 20 * * *'
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘
  push:
    paths:
      - 'update_playlist.py'  # å½“Pythonè„šæœ¬æ›´æ”¹æ—¶ä¹Ÿè‡ªåŠ¨è¿è¡Œ

jobs:
  update-playlist:
    name: ğŸ“º Update Korean TV Channels
    runs-on: ubuntu-latest
    
    steps:
      # 1. æ£€å‡ºä»“åº“ä»£ç 
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GH_PAT }}  # ä½¿ç”¨æœ‰Gistæƒé™çš„token
          
      # 2. è®¾ç½®Pythonç¯å¢ƒ
      - name: ğŸ Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          
      # 3. å®‰è£…ä¾èµ–
      - name: ğŸ“¦ Install dependencies
        run: |
          pip install requests
          pip list
          
      # 4. æ˜¾ç¤ºå½“å‰ç›®å½•ç»“æ„ï¼ˆç”¨äºè°ƒè¯•ï¼‰
      - name: ğŸ“ Debug file structure
        run: |
          echo "å½“å‰ç›®å½•:"
          pwd
          echo "æ–‡ä»¶åˆ—è¡¨:"
          ls -la
          echo "Pythonæ–‡ä»¶å†…å®¹:"
          cat update_playlist.py || echo "æ–‡ä»¶ä¸å­˜åœ¨"
          
      # 5. è¿è¡Œæ›´æ–°è„šæœ¬
      - name: ğŸš€ Run update script
        env:
          GH_PAT: ${{ secrets.GH_PAT }}
        run: python update_playlist.py
        
      # 6. æ˜¾ç¤ºæ‰§è¡Œç»“æœ
      - name: âœ… Completion status
        run: |
          echo "ğŸ‰ GitHub Actions æ‰§è¡Œå®Œæˆï¼"
          echo "ğŸ“… ä¸‹æ¬¡è‡ªåŠ¨è¿è¡Œæ—¶é—´: UTC 20:00 (åŒ—äº¬æ—¶é—´ 04:00)"
          echo "ğŸ”— æŸ¥çœ‹Gist: https://gist.github.com/GoonhoLee/9633c3cc086e124fe6d97c50f6321b39"
